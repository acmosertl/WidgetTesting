<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>üåº ‡¶Æ‡¶æ‡¶ß‡¶¨‡¶Æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ vC2</title>
<style>
:root{
  --bg:#fff9e6;--card:#fffef7;--red:#b71c1c;--gold:#ffd740;
  --purple:#6a1b9a;--shadow:0 4px 14px rgba(0,0,0,.1);
}
body{margin:0;background:var(--bg);font-family:"Noto Sans Bengali",sans-serif;color:#222;}
.wrap{max-width:420px;margin:18px auto;padding:10px;}
.card{background:var(--card);border-radius:18px;box-shadow:var(--shadow);
padding:16px;text-align:center;margin-bottom:12px;}
h2{margin:0;color:var(--red);font-family:"Him",sans-serif;}
.name{color:#ff6f00;font-size:28px;font-weight:900;text-shadow:0 0 10px rgba(255,111,0,.4);}
.meta{font-size:16px;font-weight:600;margin-top:4px;}
.paran{font-size:15px;color:var(--purple);margin-top:6px;}
.tick{color:#00c853;font-weight:700;font-size:16px;margin-left:4px;}
button.trigger{background:#fff8e1;border:none;color:var(--purple);
font-weight:700;padding:10px 18px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1);
cursor:pointer;transition:.3s;}
button.trigger:hover{box-shadow:0 0 12px #ffd740;}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;
background:rgba(0,0,0,.5);backdrop-filter:blur(4px);}
.modal-content{background:#fffef8;margin:8% auto;padding:16px;border-radius:16px;
max-width:480px;box-shadow:var(--shadow);}
table{width:100%;border-collapse:collapse;text-align:center;font-size:14px;}
th{background:#f3e5f5;color:var(--purple);padding:6px;}
td{padding:6px;border-bottom:1px solid #eee;}
.close{float:right;font-weight:900;cursor:pointer;color:var(--red);}
</style>
</head>
<body>
<div class="wrap">
  <section class="card" id="ekaCard">
    <h2>üåº ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ</h2>
    <div class="name" id="ekaName">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
    <div class="meta" id="ekaDate">‚Äî</div>
    <div class="meta" id="ekaMsg">‚Äî</div>
    <div class="paran" id="ekaParan">‚Äî</div>
  </section>
  <div style="text-align:center">
    <button class="trigger" id="openCal">üìÖ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞</button>
  </div>
</div>

<!-- Popup -->
<div id="calModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closeCal">‚úñ</span>
    <h2 style="text-align:center">üå∏ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞</h2>
    <table>
      <thead><tr><th>‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ</th><th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th><th>‡¶™‡¶æ‡¶∞‡¶£</th></tr></thead>
      <tbody id="calBody"></tbody>
    </table>
  </div>
</div>

<script>
// üå∏ ‡¶á‡¶∏‡¶ï‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡ßã‡¶∞‡ßç‡¶∏ (free public JSON)
const ISKCON_API = const ISKCON_API = "/api/ekadashi";

async function loadEkadashi(){
  try{
    const res = await fetch(ISKCON_API);
    const data = await res.json();
    const today = new Date();

    // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞
    const ekas = data.events.filter(e => e.type && e.type.toLowerCase().includes("ekadasi"));
    if(!ekas.length) throw new Error("No Ekadashi data");

    // ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡¶æ ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ ‡¶¨‡¶æ‡¶õ‡¶æ‡¶á
    const nextEka = ekas.find(e=> new Date(e.date)>=today) || ekas[0];
    const eDate = new Date(nextEka.date);
    const diff = Math.ceil((eDate - today)/(1000*60*60*24));
    let msg = diff<=0 ? "‡¶Ü‡¶ú ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ üå∏" : `${diff} ‡¶¶‡¶ø‡¶® ‡¶¨‡¶æ‡¶ï‡¶ø`;

    // ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    ekaName.innerHTML = `${nextEka.name_bn || nextEka.name}<span class="tick">‚úÖ</span>`;
    ekaDate.textContent = `üìÖ ${eDate.toLocaleDateString('bn-BD',{year:'numeric',month:'long',day:'numeric'})}`;
    ekaMsg.textContent = msg;
    ekaParan.textContent = nextEka.paran || "‡¶™‡¶æ‡¶∞‡¶£‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º: ‡¶™‡¶∞‡ßá‡¶∞ ‡¶¶‡¶ø‡¶® ‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßã‡¶¶‡¶Ø‡¶º ‡¶™‡¶∞";

    // ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶≠‡¶∞‡ßã
    const body=document.getElementById("calBody");
    body.innerHTML="";
    ekas.forEach(e=>{
      const d=new Date(e.date);
      const row=`<tr>
        <td>${e.name_bn||e.name}</td>
        <td>${d.toLocaleDateString('bn-BD',{year:'numeric',month:'short',day:'numeric'})}</td>
        <td>${e.paran||'‚Äî'}</td>
      </tr>`;
      body.innerHTML+=row;
    });

    // ‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßã‡¶¶‡¶Ø‡¶º ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ (‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡¶ï‡¶æ‡¶≤ ‡ß´‡¶ü‡¶æ)
    const now=new Date();
    const nextSunrise=new Date(now.getFullYear(),now.getMonth(),now.getDate()+1,5,0,0);
    const delay=nextSunrise-now;
    setTimeout(loadEkadashi,delay);

  }catch(err){
    ekaName.textContent="‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶°‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá";
    console.error(err);
  }
}

// Popup control
openCal.onclick=()=>{calModal.style.display="block";};
closeCal.onclick=()=>{calModal.style.display="none";};
window.onclick=e=>{if(e.target==calModal)calModal.style.display="none";};

// ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßã
loadEkadashi();
</script>
</body>
</html>
